<div class="card w-full lg:w-96 bg-base-200 shadow-xl border-2 transition-all" [ngClass]="{
       'border-primary': isPlayer(),
       'border-error': !isPlayer() && !character().isDead,
       'opacity-50 grayscale': character().isDead
     }">

    <div class="card-body p-4 gap-3">
        <div class="flex justify-between items-start">
            <h2 class="card-title text-md font-bold truncate">{{ character().name }}</h2>
            @if (character().isDead) {
            <div class="badge badge-ghost badge-sm">DEAD</div>
            }
        </div>

        <div class="grid grid-cols-1 gap-2">
            <div class="flex flex-col gap-0.5">
                <div class="flex justify-between text-[10px] font-bold">
                    <span>HP</span>
                    <span>{{ character().currentHealth }}/{{ character().maxHealth }}</span>
                </div>
                <progress class="progress progress-error w-full h-2" [value]="healthPercentage()" max="100"></progress>
            </div>

            @if (character().maxMana > 0) {
            <div class="flex flex-col gap-0.5">
                <div class="flex justify-between text-[10px] font-bold">
                    <span>MP</span>
                    <span>{{ character().currentMana }}/{{ character().maxMana }}</span>
                </div>
                <progress class="progress progress-info w-full h-2" [value]="manaPercentage()" max="100"></progress>
            </div>
            }
        </div>

        <div class="mt-2">
            <h3 class="text-[10px] font-bold uppercase opacity-50 mb-1">Equipment</h3>
            <div class="grid grid-cols-2 gap-1">
                @for (slot of ['Head', 'Neck', 'Chest', 'Left Hand', 'Right Hand', 'Legs', 'Feet']; track slot) {
                <div class="text-[10px] bg-base-300 p-1 rounded px-2 flex justify-between">
                    <span class="opacity-60">{{ slot }}:</span>
                    <span class="truncate font-medium">{{ character().equipment.get(slot)?.name || '---' }}</span>
                </div>
                }
            </div>
        </div>

        @if (isPlayer()) {
        <div class="mt-2 border-t border-base-300 pt-2">
            <h3 class="text-[10px] font-bold uppercase opacity-50 mb-1">Backpack</h3>
            <div class="flex flex-wrap gap-1">
                @for (item of character().items; track item.id) {
                <div class="badge badge-neutral text-[9px] h-auto py-1">{{ item.name }}</div>
                } @empty {
                <span class="text-[9px] italic opacity-40">Empty</span>
                }
            </div>
        </div>
        }

        <div class="text-[10px] opacity-50 text-right mt-1">
            üìç {{ character().roomCoordinates }}
        </div>
    </div>
</div>